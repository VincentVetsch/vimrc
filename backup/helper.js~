var addEvent = (function(window, document) {
    /* Adds Events to HTML Elements.  It is Cross Browser capable
    *  Arguments:
    *  - theElement:   The Element that the event will be attached to
    *  - theEvent:     The type of event to be attached to the Elements
    *  - callback:     The Callback function to be performed on the event
    *
    *  Example Usage:
    *    var lis = document.getElementsByTagName('li');
    *    addEvent( window, 'click', function() {
    *        this.style.border = '1px solid red'});
    */
    //Modern Browsers
    if (document.addEventListener) {
        return function(theElement, theEvent, callback) {
            if ((theElement && !theElement.length) || theElement === window) {
                theElement.addEventListener(theEvent, callback, false );
            }
            else if (theElement && theElement.length) {
                var len = theElement.length;
                for (var i = 0; i < len; i++) {
                    addEvent(theElement[i], theEvent, callback);
                 }
             }
         };
    }
    //IE
    else if (document.attachEvent) {
         return function (theElement, theEvent, callback) {
             if ((theElement && !theElement.length) || theElement === window) {
                 theElement.attachEvent( 'on' + theEvent, function() {
                     return callback.call(theElement, window.event)});
            }
            else if (theElement.length) {
                var len = theElement.length
                for (var i = 0; i < len; i++) {
                    addEvent(theElement[i], theEvent, callback);
                }
            }
        };
    }
})(this, document);

var unique = function(origArr) {
    /* Creates a Set out of an array
    * Arguments:
    *  - origArr = Is the unfiltered array, which may have duplicate values.
    *
    * Example Usage:
    *   var myarray = ['jeffrey', 'allie', 'patty', 'damon', 'zach', 'jeffrey', 'allie'];
    *   myarray = unique(myarray);
    *   console.log(myarray); // jeffrey, allie, patty, damon, zach
    */
    var newArr = [],
        origLen = origArr.length,
        found = false,
        i = 0,
        j = 0;

    for (i = 0; i < origLen; i++) {
        found = false; //Reset to false for the next series of tests
        for ( j = 0; j < newArr.length; j++ ) {
            if ( origArr[i] === newArr[j] ) {
              found = true; //Set true to prevent writing value to newArr
              break; //Break out of inner loop since a duplicate has been found
            }
        }
        if (!found) newArr.push(origArr[i]); //append value to newArr if found is not true
    }
    return newArr;
};

var dayOfTheWeek = function() {
    /*.dayOfTheWeek:  Checks the date of the week verses the current
        *                Day
        *
        * Arguments:
        *
        * Return:
        *    The day of the week
        */
    var x;
    var d = new Date().getDay();
    switch ( d ) {
        case 0:
            x = "Sunday"
            break;
        case 1:
            x = "Monday"
            break;
        case 2:
            x = "Tuesday"
            break;
        case 3:
            x = "Wednesday"
            break;
        case 4:
            x = "Thursday"
            break;
        case 5:
            x = "Friday"
            break;
        case 6:
            x = "Saturday"
            break;
    }
    return x
};

var isItTheWeekend = function(theId) {
    /* isItTheWeekend:  Checks the date of the week verses the current
     *                  Day
     *
     * Arguments:
     *    -theId:       The Element ID attribute
     * Return:
     *    The day of the week
     */
    var x;
    var d = new Date().getDay();
    switch ( d ) {
        case 0:
        case 6:
            x = "Weekend";
            break;
        default:
            x = "Week Day";
    }
    document.getElementById(theId).innerHTML = x;
};

var TRange=null;
function findString (str) {
    /* findString() creates a find string dialog
    *
    */
    if (parseInt(navigator.appVersion) < 4) return;
    var strFound;
    if (window.find) {
        // CODE FOR BROWSERS THAT SUPPORT window.find
        strFound=self.find(str);
        if (!strFound) {
            strFound = self.find(str,0,1);
            while (self.find(str,0,1)) continue;
        }
    } else if (navigator.appName.indexOf("Microsoft")!=-1) {
        // EXPLORER-SPECIFIC CODE
        if (TRange != null) {
            TRange.collapse(false);
            strFound = TRange.findText(str);
            if (strFound) TRange.select();
        }
        if (TRange == null || strFound == 0) {
            TRange = self.document.body.createTextRange();
            strFound = TRange.findText(str);
            if (strFound) TRange.select();
        }
    } else if (navigator.appName === "Opera") {
        alert("Opera browsers not supported, sorry...");
        return;
    }
    if (!strFound) alert ("String '"+str+"' not found!");
    return;
};

function createBookmark(sURL,sTitle) {
    if (document.all && window.external) {
        window.external.AddFavorite (sURL,sTitle);
    } else if (window.sidebar) {
        window.sidebar.addPanel(sTitle,sURL,'');
    } else {
        alert (''
        + 'Cannot programmatically add bookmarks!\n'
        + 'Please press Ctrl+D to bookmark this page.'
        );
    }
};
function writeMTable() {
    /* writeMTable(): Creates a multiplication table for print
    *
    *
    */
    top.wRef = window.open('','myconsole',
                            'width=500,height=450,left=10,top=10'
                            +',menubar=1'
                            +',toolbar=0'
                            +',status=1'
                            +',scrollbars=1'
                            +',resizable=1')

    top.wRef.document.writeln(
    '<html><head><title>Multiplication Table</title></head>'
    +'<body bgcolor=white onLoad="self.focus()">'
    +'<center><font color=red><b><i>For printing, <a href=# onclick="window.print();return false;">click here</a> or press Ctrl+P</i></b></font>'
    +'<H3>Multiplication Table</H3>'
    +'<table border=0 cellspacing=3 cellpadding=3>'
    )
    buf = '';
    //Write the row
    for (j = 1; j < 11; j++) {
        if ((j - 1) % 10 == 0) buf += '<tr>';
        buf += '<# TODO -- align=right><font size=2 face=Arial,Helvetica>';
        //Write the data
        for (i = 1; i < 11; i++) {
            buf += j + " x " + i + " = " + (j * i) + "<br>";
        }
    buf += '</font></# TODO -->';
        if (j % 5 == 0) buf += '</tr>';
    }

    top.wRef.document.writeln(buf+'</table></center></body></html>')
    top.wRef.document.close()
};
